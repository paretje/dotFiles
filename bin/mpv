#!/bin/sh
mpv() {
	# choose correct hardware acceleration
	if [ "$VDPAU_DRIVER" = "nouveau" ]; then
		/usr/bin/mpv --profile=vdpau "$@"
	elif [ "$VDPAU_DRIVER" = "va_gl" ]; then
		/usr/bin/mpv --profile=vaapi "$@"
	else
		/usr/bin/mpv "$@"
	fi
}

# do not resume playback when playing multiple files
files=0
smart=true
for arg in "$@"; do
	if [ "$arg" = "--resume-playback" -o "$arg" = "--no-resume-playback" ]; then
		smart=false
	elif [ -f "$arg" ]; then
		files=$((files+1))
	fi
done

# disable notification during playback
if $smart && test $files -gt 1; then
	mpv --no-resume-playback "$@"
else
	mpv "$@"
fi
